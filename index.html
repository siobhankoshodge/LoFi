<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manifestation Garden</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŒ±</text></svg>">
    
    <style>
        :root {
            --bg-color: #fdf6e3;
            --stem-color: #a3b18a;
            --text-color: #6d5d6e;
            --accent: #e6a4b4;
        }

        body, html {
            margin: 0; padding: 0;
            width: 100vw; height: 100vh;
            background-color: var(--bg-color);
            overflow: hidden;
            font-family: 'Courier New', Courier, monospace;
        }

        #garden { width: 100%; height: 100%; position: relative; cursor: crosshair; }

        /* Lofi Grain Filter */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; background: url('https://grainy-gradients.vercel.app/noise.svg');
            opacity: 0.12; z-index: 10;
        }

        .ui-panel {
            position: absolute; top: 20px; left: 20px; z-index: 20;
            color: var(--text-color); background: rgba(255,255,255,0.6);
            padding: 15px; border-radius: 12px; backdrop-filter: blur(8px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border: 1px solid rgba(255,255,255,0.3);
        }

        button {
            background: var(--accent); color: white; border: none;
            padding: 8px 12px; border-radius: 20px; cursor: pointer;
            font-family: inherit; transition: transform 0.2s;
        }

        button:hover { transform: scale(1.05); }

        @keyframes sway {
            0%, 100% { transform: rotate(-1.2deg); }
            50% { transform: rotate(1.2deg); }
        }

        .plant {
            position: absolute; bottom: 0; transform-origin: bottom center;
            display: flex; flex-direction: column; align-items: center;
            animation: sway 6s ease-in-out infinite;
        }

        .stem { width: 4px; background: var(--stem-color); border-radius: 2px; height: 10px; transition: height 0.8s ease-out; }

        .flower-canvas { transition: transform 2.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: scale(0); }
        .flower-canvas.bloomed { transform: scale(1); }

        .label {
            margin-top: 8px; font-size: 11px; color: var(--text-color);
            background: rgba(255,255,255,0.8); padding: 3px 10px; border-radius: 15px;
            white-space: nowrap; box-shadow: 0 2px 5px rgba(0,0,0,0.03);
            border: 1px solid rgba(0,0,0,0.05);
        }
    </style>
</head>
<body>

    <div class="overlay"></div>
    
    <div class="ui-panel">
        <strong style="font-size: 1.2em;">Summer Garden</strong><br>
        <small>Plant an intention and watch it grow.</small><br><br>
        <button onclick="toggleMusic()">â™« Toggle Music</button>
        <button onclick="clearGarden()" style="background:#ccc; margin-left:5px;">Reset</button>
    </div>

    <div id="garden"></div>

    <audio id="bgm" loop src="https://assets.mixkit.co/music/preview/mixkit-dreaming-big-31.mp3"></audio>

    <script>
        const garden = document.getElementById('garden');
        const colors = ['#ffccbb', '#ffeda0', '#91d18b', '#e1f5fe', '#f8bbd0', '#d1c4e9'];
        let plants = [];

        // Load saved garden on startup
        window.onload = () => {
            const saved = localStorage.getItem('myGarden');
            if (saved) {
                const data = JSON.parse(saved);
                data.forEach(p => createPlant(p.x, p.text, p.color, p.height, p.maxHeight));
            }
        };

        function toggleMusic() {
            const audio = document.getElementById('bgm');
            audio.play().catch(() => alert("Click the screen first to enable audio!"));
            return audio.paused ? audio.play() : audio.pause();
        }

        function clearGarden() {
            if(confirm("Clear your garden?")) {
                localStorage.removeItem('myGarden');
                location.reload();
            }
        }

        garden.addEventListener('click', (e) => {
            if (e.target.id !== 'garden') return;
            const intention = prompt("What are you manifesting?");
            if (intention) {
                const color = colors[Math.floor(Math.random() * colors.length)];
                createPlant(e.clientX, intention, color);
            }
        });

        function createPlant(x, text, color, existingHeight = 15, existingMax = null) {
            const plantObj = {
                x: x,
                text: text,
                color: color,
                height: existingHeight,
                maxHeight: existingMax || (250 + Math.random() * 350),
                element: document.createElement('div')
            };

            plantObj.element.className = 'plant';
            plantObj.element.style.left = (x - 60) + 'px';
            plantObj.element.style.animationDelay = (Math.random() * -5) + 's';

            const canvas = document.createElement('canvas');
            canvas.width = canvas.height = 120;
            canvas.className = 'flower-canvas';
            
            const stem = document.createElement('div');
            stem.className = 'stem';
            stem.style.height = plantObj.height + 'px';

            const label = document.createElement('div');
            label.className = 'label';
            label.innerText = text;

            plantObj.element.appendChild(canvas);
            plantObj.element.appendChild(stem);
            plantObj.element.appendChild(label);
            garden.appendChild(plantObj.element);

            drawFlower(canvas.getContext('2d'), color);
            
            setTimeout(() => canvas.classList.add('bloomed'), 100);

            plantObj.stemElement = stem;
            plants.push(plantObj);
            saveGarden();
        }

        function drawFlower(ctx, color) {
            const petals = 6 + Math.floor(Math.random() * 4);
            const radius = 25 + Math.random() * 10;
            ctx.translate(60, 60);
            ctx.fillStyle = color;
            for (let i = 0; i < petals; i++) {
                ctx.rotate((Math.PI * 2) / petals);
                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.quadraticCurveTo(radius, -radius, 0, -radius * 1.6);
                ctx.quadraticCurveTo(-radius, -radius, 0, 0);
                ctx.fill();
            }
            ctx.beginPath(); ctx.arc(0, 0, 7, 0, Math.PI * 2);
            ctx.fillStyle = '#fff9c4'; ctx.fill();
        }

        function saveGarden() {
            const data = plants.map(p => ({
                x: p.x, text: p.text, color: p.color, height: p.height, maxHeight: p.maxHeight
            }));
            localStorage.setItem('myGarden', JSON.stringify(data));
        }

        // CONTINUOUS GROWTH ENGINE
        setInterval(() => {
            let changed = false;
            plants.forEach(p => {
                if (p.height < p.maxHeight) {
                    p.height += 1.5;
                    p.stemElement.style.height = p.height + 'px';
                    changed = true;
                }
            });
            if (changed) saveGarden();
        }, 4000);

    </script>
</body>
</html>
